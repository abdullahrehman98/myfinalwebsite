---
categories:
- ""
- ""
date: "2017-10-31T22:26:09-05:00"
description: This is a data analytics assignment 
draft: false
image: pic09.jpg
keywords: ""
slug: data
title: Applied Statistics Assignment
---

```{r load-libraries, warning=FALSE, message=FALSE, echo=FALSE}
library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages
library(gapminder)  # gapminder dataset
library(here)
library(janitor)
library(knitr)
library(ggplot2)
library(kableExtra)
knitr::opts_chunk$set(echo = FALSE)
```
# Brexit vote analysis

We will have a look at the results of the 2016 Brexit vote in the UK. 

```{r load_brexit_data, warning=FALSE, message=FALSE,echo=FALSE}
brexit_results <- read_csv(here::here("data","brexit_results.csv"))

glimpse(brexit_results)
```

The data comes from [Elliott Morris](https://www.thecrosstab.com/), who cleaned it and made it available through his [DataCamp class on analysing election and polling data in R](https://www.datacamp.com/courses/analyzing-election-and-polling-data-in-r).


```{r brexit_histogram1, warning=FALSE, message=FALSE,echo=FALSE, out.width="100%"}

brexit_results%>%
  
  ggplot(aes())+
  geom_point(aes(x=con_2015,y=leave_share, color="Conservative"),alpha=0.5,size=0.8)+
  geom_point(aes(x=lab_2015,y=leave_share,color="Labour"),alpha=0.5,size=0.8)+
  geom_point(aes(x=ld_2015, y=leave_share,color="Lib Dems"),alpha=0.5,size=0.8)+
  geom_point(aes(x=ukip_2015, y=leave_share,color="UKIP"),alpha=0.5,size=0.8)+
  geom_smooth(aes(x=con_2015,y=leave_share),method=lm, color="#0087dc")+
  geom_smooth(aes(x=lab_2015,y=leave_share),method=lm,color="#d50000")+
  geom_smooth(aes(x=ld_2015,y=leave_share),method=lm, color="#FDBB30")+
  geom_smooth(aes(x=ukip_2015,y=leave_share),method=lm, color="#EFE600")+
  
  scale_color_manual(name="",
                     values = c("Conservative"="#0087dc",
                                "Labour"="#d50000",
                                "Lib Dems"="#FDBB30",
                                "UKIP"="#EFE600"))+
  labs(title = "How political affiliation translated to Brexit Voting", y="Leave % in the 2016 Brexit referendum", x="Party % in the UK 2015 general election")

# histogram
ggplot(brexit_results, aes(x = leave_share)) +
  geom_histogram(binwidth = 2.5)+
  labs(title = "Brexit Leave Share Mapped",
       subtitle = "Histogram",
       caption = "Figure 3.1",
       x= "Leave Share (Percent of votes cast in favour of Brexit)",
       y="Frequency of Constituencies")+
  theme(plot.caption = element_text(hjust = 0))
```
We can also create a scatterplot between these two variables using `geom_point`. We also add the best fit line, using `geom_smooth(method = "lm")`.

```{r brexit_immigration_plot,message=FALSE,warning=FALSE}
ggplot(brexit_results, aes(x = born_in_uk, y = leave_share)) +
  geom_point(alpha=0.3) +
  
  # add a smoothing line, and use method="lm" to get the best straight-line
  geom_smooth(method = "lm") + 
  
  # use a white background and frame the plot with a black box
  theme_bw() +
  labs(x="Born in the UK",
       y="Leave Share",
       title = "Realtionship b/w the proportion of native born residents & leave share",
       subtitle = "Scatterplot",
       caption = 'Figure 3.4')+
  theme(plot.caption = element_text(hjust = 0))
  NULL
```
